#!/usr/bin/env python
import pymysql.cursors

cnx = pymysql.connect(user='admin', password='password',
                              host='machines-database.cvczlcshulp9.us-east-2.rds.amazonaws.com',
                              database='machines_database',
                              cursorclass=pymysql.cursors.Cursor)

cursor = cnx.cursor()

# Machine 100001
print('var mydata = {"type": "FeatureCollection", "features": [', file=open("lab06geojson3.js", "w"))
print("", file=open("lab06geojson3.js", "a"))
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates": [',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100001")
la1 = str(cursor.fetchone())
lat01 = print(la1[2],la1[3],la1[4],la1[5],la1[6],la1[7],la1[8],la1[9],la1[10],la1[11],la1[12],la1[13],la1[14],la1[15],la1[16],la1[17],la1[18],la1[19], sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100001")
lo1 = str(cursor.fetchone())
long01 = print(", ", lo1[2],lo1[3],lo1[4],lo1[5],lo1[6],lo1[7],lo1[8],lo1[9],lo1[10],lo1[11],lo1[12],lo1[13],lo1[14],lo1[15],lo1[16],lo1[17],lo1[18],lo1[19],"]},",sep="", file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100001", ', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100001")
p1 = str(cursor.fetchone())
pep01 = print(' "Pepsi":'," ",p1[1],p1[2],", ",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100001")
dp1 = str(cursor.fetchone())
dpep01 = print(' "Diet Pepsi":'," ",dp1[1],dp1[2],", ",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100001")
dr1 = str(cursor.fetchone())
drpep01 = print(' "Dr Pepper":'," ",dr1[1],dr1[2],", ",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100001")
mtd1 = str(cursor.fetchone())
mtnd01 = print(' "Mountain Dew":'," ",mtd1[1],mtd1[2],", ",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100001")
sm1 = str(cursor.fetchone())
mist01 = print(' "Sierra Mist":'," ",sm1[1],sm1[2],", ",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100001")
mny1 = str(cursor.fetchone())
money01 = print(' "Total $":'," ",mny1[1],mny1[2],mny1[3],mny1[4],mny1[5],"}},", sep="", file=open("lab06geojson3.js", "a"))
print("", file=open("lab06geojson3.js", "a"))

# Machine100002
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates":',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100002")
la2 = str(cursor.fetchone())
lat02 = print(" [",la2[2],la2[3],la2[4],la2[5],la2[6],la2[7],la2[8],la2[9],la2[10],la2[11],la2[12],la2[13],la2[14],la2[15],la2[16],la2[17],la2[18],la2[19],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100002")
lo2 = str(cursor.fetchone())
long02 = print(" ",lo2[2],lo2[3],lo2[4],lo2[5],lo2[6],lo2[7],lo2[8],lo2[9],lo2[10],lo2[11],lo2[12],lo2[13],lo2[14],lo2[15],lo2[16],lo2[17],lo2[18],"]},",sep="",file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100002", ', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100002")
p2 = str(cursor.fetchone())
pep02 = print(' "Pepsi":'," ",p2[1],p2[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100002")
dp2 = str(cursor.fetchone())
dpep02 = print(' "Diet Pepsi":'," ",dp2[1],dp2[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100002")
dr2 = str(cursor.fetchone())
drpep02 = print(' "Dr Pepper":'," ",dr2[1],dr2[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100002")
mtd2 = str(cursor.fetchone())
mtnd02 = print(' "Mountain Dew":'," ",mtd2[1],mtd2[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100002")
sm2 = str(cursor.fetchone())
mist02 = print(' "Sierra Mist":'," ",sm2[1],sm2[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100002")
mny2 = str(cursor.fetchone())
money02 = print(' "Total $":'," ",mny2[1],mny2[2],mny2[3],mny2[4],mny2[5],"}},",sep="", file=open("lab06geojson3.js", "a"))
print("", file=open("lab06geojson3.js", "a"))

# Machine 100003
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates":',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100003")
la3 = str(cursor.fetchone())
lat03 = print(" [",la3[2],la3[3],la3[4],la3[5],la3[6],la3[7],la3[8],la3[9],la3[10],la3[11],la3[12],la3[13],la3[14],la3[15],la3[16],la3[17],la3[18],la3[19],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100003")
lo3 = str(cursor.fetchone())
long03 = print(" ",lo3[2],lo3[3],lo3[4],lo3[5],lo3[6],lo3[7],lo3[8],lo3[9],lo3[10],lo3[11],lo3[12],lo3[13],lo3[14],lo3[15],lo3[16],lo3[17],lo3[18],"]},",sep="",file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100003",', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100003")
p3 = str(cursor.fetchone())
pep03 = print(' "Pepsi":'," ",p3[1],p3[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100003")
dp3 = str(cursor.fetchone())
dpep03 = print(' "Diet Pepsi":'," ",dp3[1],dp3[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100003")
dr3 = str(cursor.fetchone())
drpep03 = print(' "Dr Pepper":'," ",dr3[1],dr3[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100003")
mtd3 = str(cursor.fetchone())
mtnd03 = print(' "Mountain Dew":'," ",mtd3[1],mtd3[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100003")
sm3 = str(cursor.fetchone())
mist03 = print(' "Sierra Mist":'," ",sm3[1],sm3[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100003")
mny3 = str(cursor.fetchone())
money03 = print(' "Total $":'," ",mny3[1],mny3[2],mny3[3],mny3[4],mny3[5],"}},",sep="", file=open("lab06geojson3.js", "a"))
print("", file=open("lab06geojson3.js", "a"))

# Machine 100004
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates":',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100004")
la4 = str(cursor.fetchone())
lat04 = print(" [",la4[2],la4[3],la4[4],la4[5],la4[6],la4[7],la4[8],la4[9],la4[10],la4[11],la4[12],la4[13],la4[14],la4[15],la4[16],la4[17],la4[18],la4[19],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100004")
lo4 = str(cursor.fetchone())
long04 = print(" ",lo4[2],lo4[3],lo4[4],lo4[5],lo4[6],lo4[7],lo4[8],lo4[9],lo4[10],lo4[11],lo4[12],lo4[13],lo4[14],lo4[15],lo4[16],lo4[17],lo4[18],"]},",sep="",file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100004",', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100004")
p4 = str(cursor.fetchone())
pep04 = print(' "Pepsi":'," ",p4[1],p4[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100004")
dp4 = str(cursor.fetchone())
dpep04 = print(' "Diet Pepsi":'," ",dp4[1],dp4[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100004")
dr4 = str(cursor.fetchone())
drpep04 = print(' "Dr Pepper":'," ",dr4[1],dr4[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100004")
mtd4 = str(cursor.fetchone())
mtnd04 = print(' "Mountain Dew":'," ",mtd4[1],mtd4[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100004")
sm4 = str(cursor.fetchone())
mist04 = print(' "Sierra Mist":'," ",sm4[1],sm4[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100004")
mny4 = str(cursor.fetchone())
money04 = print(' "Total $":'," ",mny4[1],mny4[2],mny4[3],mny4[4],mny4[5],"}},",sep="", file=open("lab06geojson3.js", "a"))
print("", file=open("lab06geojson3.js", "a"))

# Machine 100005
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates":',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100005")
la5 = str(cursor.fetchone())
lat05 = print(" [",la5[2],la5[3],la5[4],la5[5],la5[6],la5[7],la5[8],la5[9],la5[10],la5[11],la5[12],la5[13],la5[14],la5[15],la5[16],la5[17],la5[18],la5[19],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100005")
lo5 = str(cursor.fetchone())
long05 = print(" ",lo5[2],lo5[3],lo5[4],lo5[5],lo5[6],lo5[7],lo5[8],lo5[9],lo5[10],lo5[11],lo5[12],lo5[13],lo5[14],lo5[15],lo5[16],lo5[17],lo5[18],"]},",sep="",file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100005",', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100005")
p5 = str(cursor.fetchone())
pep05 = print(' "Pepsi":'," ",p5[1],p5[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100005")
dp5 = str(cursor.fetchone())
dpep05 = print(' "Diet Pepsi":'," ",dp5[1],dp5[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100005")
dr5 = str(cursor.fetchone())
drpep05 = print(' "Dr Pepper":'," ",dr5[1],dr5[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100005")
mtd5 = str(cursor.fetchone())
mtnd05 = print(' "Mountain Dew":'," ",mtd5[1],mtd5[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100005")
sm5 = str(cursor.fetchone())
mist05 = print(' "Sierra Mist":'," ",sm5[1],sm5[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100005")
mny5 = str(cursor.fetchone())
money05 = print(' "Total $":'," ",mny5[1],mny5[2],mny5[3],mny5[4],mny5[5],"}},",sep="", file=open("lab06geojson3.js", "a"))
print("", file=open("lab06geojson3.js", "a"))

# Machine 100006
print('{"type": "Feature", "geometry": {"type": "Point", "coordinates":',file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT latitude FROM location WHERE machine_id = 100006")
la6 = str(cursor.fetchone())
lat06 = print(" [",la6[2],la6[3],la6[4],la6[5],la6[6],la6[7],la6[8],la6[9],la6[10],la6[11],la6[12],la6[13],la6[14],la6[15],la6[16],la6[17],la6[18],la6[19],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT longitude FROM location WHERE machine_id = 100006")
lo6 = str(cursor.fetchone())
long06 = print(" ",lo6[2],lo6[3],lo6[4],lo6[5],lo6[6],lo6[7],lo6[8],lo6[9],lo6[10],lo6[11],lo6[12],lo6[13],lo6[14],lo6[15],lo6[16],lo6[17],"]},",sep="",file=open("lab06geojson3.js", "a"))
print(' "properties": {"Machine ID": "100006",', file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT pe_qty FROM inventory WHERE machine_id = 100006")
p6 = str(cursor.fetchone())
pep06 = print(' "Pepsi":'," ",p6[1],p6[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dp_qty FROM inventory WHERE machine_id = 100006")
dp6 = str(cursor.fetchone())
dpep06 = print(' "Diet Pepsi":'," ",dp6[1],dp6[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT dr_qty FROM inventory WHERE machine_id = 100006")
dr6 = str(cursor.fetchone())
drpep06 = print(' "Dr Pepper":'," ",dr6[1],dr6[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT md_qty FROM inventory WHERE machine_id = 100006")
mtd6 = str(cursor.fetchone())
mtnd06 = print(' "Mountain Dew":'," ",mtd6[1],mtd6[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT sm_qty FROM inventory WHERE machine_id = 100006")
sm6 = str(cursor.fetchone())
mist06 = print(' "Sierra Mist":'," ",sm6[1],sm6[2],",",sep="", file=open("lab06geojson3.js", "a"))
cursor.execute("SELECT machine_total FROM money WHERE machine_id = 100006")
mny6 = str(cursor.fetchone())
money06 = print(' "Total $":'," ",mny6[1],mny6[2],mny6[3],mny6[4],mny6[5],"}}",sep="", file=open("lab06geojson3.js", "a"))
print(']}', file=open("lab06geojson3.js", "a"))

openFile = open('lab06geojson3.js', 'r')
Lines = openFile.readlines()
line0  = print(Lines[0].strip(), file=open("lab06geojson4.js", "w"))
line1 = print("", file=open("lab06geojson4.js", "a"))
line2 = print(Lines[2].strip() + Lines[3].strip() + Lines[4].strip() + Lines[5].strip() + Lines[6].strip() + Lines[7].strip() + Lines[8].strip() + Lines[9].strip() + Lines[10].strip() + Lines[11].strip(), file=open("lab06geojson4.js", "a"))
line3 = print("", file=open("lab06geojson4.js", "a"))
line4 = print(Lines[12].strip() + Lines[13].strip() + Lines[14].strip() + Lines[15].strip() + Lines[16].strip() + Lines[17].strip() + Lines[18].strip() + Lines[19].strip() + Lines[20].strip() + Lines[21].strip() + Lines[22].strip() + Lines[23].strip(), file=open("lab06geojson4.js", "a"))
line5 = print("", file=open("lab06geojson4.js", "a"))
line6 = print(Lines[24].strip() + Lines[25].strip() + Lines[26].strip() + Lines[27].strip() + Lines[28].strip() + Lines[29].strip() + Lines[30].strip() + Lines[31].strip() + Lines[32].strip() + Lines[33].strip(), file=open("lab06geojson4.js", "a"))
line7 = print("", file=open("lab06geojson4.js", "a"))
line8 =  print(Lines[34].strip() + Lines[35].strip() + Lines[36].strip() + Lines[37].strip() + Lines[38].strip() + Lines[39].strip() + Lines[40].strip() + Lines[41].strip() + Lines[42].strip() + Lines[43].strip() + Lines[44].strip() + Lines[45].strip(), file=open("lab06geojson4.js", "a"))
line9 = print("", file=open("lab06geojson4.js", "a"))
line10 = print(Lines[46].strip() + Lines[47].strip() + Lines[48].strip() + Lines[49].strip() + Lines[50].strip() + Lines[51].strip() + Lines[52].strip() + Lines[53].strip() + Lines[54].strip() + Lines[55].strip() + Lines[56].strip(), file=open("lab06geojson4.js", "a"))
line11 = print("", file=open("lab06geojson4.js", "a"))
line12 = print(Lines[57].strip() + Lines[58].strip()+ Lines[59].strip()+ Lines[60].strip()+ Lines[61].strip()+ Lines[62].strip()+ Lines[63].strip()+ Lines[64].strip()+ Lines[65].strip() + Lines[66].strip(), file=open("lab06geojson4.js", "a"))
line13 = print("", file=open("lab06geojson4.js", "a"))
line14 = print(Lines[67].strip(), file=open("lab06geojson4.js", "a"))
